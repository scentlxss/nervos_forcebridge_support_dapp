import { Platform, Provider } from './provider';
import { Address, AddressType, getDefaultPrefix, AddressPrefix as PwAddressPrefix, } from '../models';
import { AddressPrefix, privateKeyToAddress, } from '@nervosnetwork/ckb-sdk-utils';
import { Blake2bHasher } from '../hashers';
import ECPair from '@nervosnetwork/ckb-sdk-utils/lib/ecpair';
export class RawProvider extends Provider {
    constructor(privateKey) {
        super(Platform.ckb);
        this.privateKey = privateKey;
        this.keyPair = new ECPair(privateKey);
    }
    async init() {
        const pwPrefix = getDefaultPrefix();
        const prefix = pwPrefix === PwAddressPrefix.ckb
            ? AddressPrefix.Mainnet
            : AddressPrefix.Testnet;
        const address = privateKeyToAddress(this.privateKey, { prefix });
        this.address = new Address(address, AddressType.ckb);
        return this;
    }
    hasher() {
        return new Blake2bHasher();
    }
    async sign(message) {
        const sig = this.keyPair.signRecoverable(message);
        return sig;
    }
    async close() {
        return true;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmF3LXByb3ZpZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Byb3ZpZGVycy9yYXctcHJvdmlkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDaEQsT0FBTyxFQUNMLE9BQU8sRUFDUCxXQUFXLEVBQ1gsZ0JBQWdCLEVBQ2hCLGFBQWEsSUFBSSxlQUFlLEdBQ2pDLE1BQU0sV0FBVyxDQUFDO0FBQ25CLE9BQU8sRUFDTCxhQUFhLEVBQ2IsbUJBQW1CLEdBQ3BCLE1BQU0sOEJBQThCLENBQUM7QUFDdEMsT0FBTyxFQUFFLGFBQWEsRUFBVSxNQUFNLFlBQVksQ0FBQztBQUNuRCxPQUFPLE1BQU0sTUFBTSx5Q0FBeUMsQ0FBQztBQUU3RCxNQUFNLE9BQU8sV0FBWSxTQUFRLFFBQVE7SUFFdkMsWUFBc0IsVUFBa0I7UUFDdEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQURBLGVBQVUsR0FBVixVQUFVLENBQVE7UUFFdEMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRUQsS0FBSyxDQUFDLElBQUk7UUFDUixNQUFNLFFBQVEsR0FBRyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3BDLE1BQU0sTUFBTSxHQUNWLFFBQVEsS0FBSyxlQUFlLENBQUMsR0FBRztZQUM5QixDQUFDLENBQUMsYUFBYSxDQUFDLE9BQU87WUFDdkIsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUM7UUFDNUIsTUFBTSxPQUFPLEdBQUcsbUJBQW1CLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDakUsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3JELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELE1BQU07UUFDSixPQUFPLElBQUksYUFBYSxFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVELEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBZTtRQUN4QixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNsRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7SUFFRCxLQUFLLENBQUMsS0FBSztRQUNULE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztDQUNGIn0=
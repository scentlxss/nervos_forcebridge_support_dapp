"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.RawProvider = void 0;
const provider_1 = require("./provider");
const models_1 = require("../models");
const ckb_sdk_utils_1 = require("@nervosnetwork/ckb-sdk-utils");
const hashers_1 = require("../hashers");
const ecpair_1 = __importDefault(require("@nervosnetwork/ckb-sdk-utils/lib/ecpair"));
class RawProvider extends provider_1.Provider {
    constructor(privateKey) {
        super(provider_1.Platform.ckb);
        this.privateKey = privateKey;
        this.keyPair = new ecpair_1.default(privateKey);
    }
    async init() {
        const pwPrefix = models_1.getDefaultPrefix();
        const prefix = pwPrefix === models_1.AddressPrefix.ckb
            ? ckb_sdk_utils_1.AddressPrefix.Mainnet
            : ckb_sdk_utils_1.AddressPrefix.Testnet;
        const address = ckb_sdk_utils_1.privateKeyToAddress(this.privateKey, { prefix });
        this.address = new models_1.Address(address, models_1.AddressType.ckb);
        return this;
    }
    hasher() {
        return new hashers_1.Blake2bHasher();
    }
    async sign(message) {
        const sig = this.keyPair.signRecoverable(message);
        return sig;
    }
    async close() {
        return true;
    }
}
exports.RawProvider = RawProvider;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmF3LXByb3ZpZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Byb3ZpZGVycy9yYXctcHJvdmlkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEseUNBQWdEO0FBQ2hELHNDQUttQjtBQUNuQixnRUFHc0M7QUFDdEMsd0NBQW1EO0FBQ25ELHFGQUE2RDtBQUU3RCxNQUFhLFdBQVksU0FBUSxtQkFBUTtJQUV2QyxZQUFzQixVQUFrQjtRQUN0QyxLQUFLLENBQUMsbUJBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQURBLGVBQVUsR0FBVixVQUFVLENBQVE7UUFFdEMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLGdCQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUVELEtBQUssQ0FBQyxJQUFJO1FBQ1IsTUFBTSxRQUFRLEdBQUcseUJBQWdCLEVBQUUsQ0FBQztRQUNwQyxNQUFNLE1BQU0sR0FDVixRQUFRLEtBQUssc0JBQWUsQ0FBQyxHQUFHO1lBQzlCLENBQUMsQ0FBQyw2QkFBYSxDQUFDLE9BQU87WUFDdkIsQ0FBQyxDQUFDLDZCQUFhLENBQUMsT0FBTyxDQUFDO1FBQzVCLE1BQU0sT0FBTyxHQUFHLG1DQUFtQixDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ2pFLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxnQkFBTyxDQUFDLE9BQU8sRUFBRSxvQkFBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3JELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELE1BQU07UUFDSixPQUFPLElBQUksdUJBQWEsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQWU7UUFDeEIsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbEQsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBRUQsS0FBSyxDQUFDLEtBQUs7UUFDVCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7Q0FDRjtBQTlCRCxrQ0E4QkMifQ==